#include <stdio.h>
#include <stdlib.h>
#include <string.h>

#define MAX 50

typedef struct
{
    int key;
    char name[50];
} EMP;

EMP *HT[MAX];   // Hash Table

int hash(int key, int m);
void insert(EMP *e, int m);
EMP* search(int key, int m);

int main()
{
    int m, i, key;
    char name[50];

    printf("Enter hash table size (m): ");
    scanf("%d", &m);
    for(i = 0; i < m; i++)
        HT[i] = NULL;

    FILE *fp = fopen("employee.txt", "r");
    if(fp == NULL)
    {
        printf("File not found!\n");
        return 0;
    }

    while(fscanf(fp, "%d %s", &key, name) != EOF)
    {
        EMP *e = (EMP*)malloc(sizeof(EMP));
        e->key = key;
        strcpy(e->name, name);

        insert(e, m);
    }

    fclose(fp);
    printf("Enter key to search: ");
    scanf("%d", &key);

    EMP *found = search(key, m);

    if(found != NULL)
        printf("Found: %d  %s\n", found->key, found->name);
    else
        printf("Record not found!\n");

    return 0;
}
int hash(int key, int m)
{
    return key % m;
}
void insert(EMP *e, int m)
{
    int i = hash(e->key, m);

    while(HT[i] != NULL)
        i = (i + 1) % m;

    HT[i] = e;
}
EMP* search(int key, int m)
{
    int i = hash(key, m);
    int start = i;

    while(HT[i] != NULL)
    {
        if(HT[i]->key == key)
            return HT[i];

        i = (i + 1) % m;

        if(i == start)  // full loop completed
            break;
    }
    return NULL;
}

